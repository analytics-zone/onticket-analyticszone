---
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
  lang?: 'ca' | 'es' | 'en';
  ogImage?: string;
}

const { 
  title, 
  description = "onticket - App de gestió de despeses personals", 
  lang = 'ca',
  ogImage = '/favicon.png'
} = Astro.props;

const siteUrl = 'https://onticket.analyticszone.app';
const currentPath = Astro.url.pathname;

// Get base path without language prefix for hreflang
const pathWithoutLang = currentPath.replace(/^\/(ca|es|en)/, '') || '/';

// Language-specific metadata
const langMeta = {
  ca: {
    locale: 'ca_ES',
    siteName: 'onticket - Control de Despeses',
    defaultDesc: "L'app intel·ligent per gestionar l'economia personal i familiar. Segura, privada i en el teu idioma."
  },
  es: {
    locale: 'es_ES',
    siteName: 'onticket - Control de Gastos',
    defaultDesc: 'La app inteligente para gestionar la economía personal y familiar. Segura, privada y en tu idioma.'
  },
  en: {
    locale: 'en_US',
    siteName: 'onticket - Expense Tracker',
    defaultDesc: 'The smart app to manage personal and family finances. Secure, private and in your language.'
  }
};

const meta = langMeta[lang];
const finalDescription = description === "onticket - App de gestió de despeses personals" ? meta.defaultDesc : description;
---

<!doctype html>
<html lang={lang} class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={finalDescription} />
    <meta name="author" content="Analytics Zone" />
    <meta name="robots" content="index, follow" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="apple-touch-icon" href="/favicon.png" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={`${siteUrl}${currentPath}`} />
    
    <!-- Hreflang for multi-language SEO -->
    <link rel="alternate" hreflang="ca" href={`${siteUrl}/ca${pathWithoutLang}`} />
    <link rel="alternate" hreflang="es" href={`${siteUrl}/es${pathWithoutLang}`} />
    <link rel="alternate" hreflang="en" href={`${siteUrl}/en${pathWithoutLang}`} />
    <link rel="alternate" hreflang="x-default" href={`${siteUrl}/en${pathWithoutLang}`} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={`${siteUrl}${currentPath}`} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={finalDescription} />
    <meta property="og:image" content={`${siteUrl}${ogImage}`} />
    <meta property="og:locale" content={meta.locale} />
    <meta property="og:site_name" content={meta.siteName} />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={`${siteUrl}${currentPath}`} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={finalDescription} />
    <meta name="twitter:image" content={`${siteUrl}${ogImage}`} />
    
    <!-- App-specific meta -->
    <meta name="application-name" content="onticket" />
    <meta name="apple-mobile-web-app-title" content="onticket" />
    <meta name="theme-color" content="#001a8e" />
    
    <!-- Keywords -->
    <meta name="keywords" content="despeses, gastos, expenses, control, gestió, tracking, app, iOS, Android, català, español, English" />
    
    <!-- Astro Generator -->
    <meta name="generator" content={Astro.generator} />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  </head>
  <body class="bg-surface antialiased">
    <slot />
  </body>
</html>
